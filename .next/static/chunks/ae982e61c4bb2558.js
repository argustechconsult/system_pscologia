(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82646,e=>{"use strict";let s=(0,e.i(69547).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>s],82646)},75878,e=>{"use strict";let s=(0,e.i(69547).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],75878)},50056,e=>{"use strict";var s=e.i(91398),t=e.i(61905),a=e.i(91788),l=e.i(98957),i=e.i(69547);let r=(0,i.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);var n=e.i(82646);let d=(0,i.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),c=(0,i.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var o=e.i(75878),x=e.i(20019);let m=({clients:e})=>{let[t,i]=(0,a.useState)(null),[m,h]=(0,a.useState)(null),p=(0,a.useMemo)(()=>{let s=new Date;return e.filter(e=>{if("inactive"===e.status)return!0;if(!e.lastSessionDate)return!1;let t=new Date(e.lastSessionDate);return Math.ceil(Math.abs(s.getTime()-t.getTime())/864e5)>60})},[e]),u=async e=>{i(e.id);let s=await (0,x.generateRetentionMessage)(e.name,e.lastSessionDate);h({clientId:e.id,message:s||""}),i(null)};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Ferramenta de Retenção"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Recupere pacientes que deixaram de se consultar recentemente."})]}),(0,s.jsxs)("div",{className:"bg-blue-50 px-4 py-2 rounded-xl flex items-center gap-2 text-blue-600 font-bold border border-blue-100",children:[(0,s.jsx)(c,{size:18}),p.length," Pacientes Inativos"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-slate-700 flex items-center gap-2",children:[(0,s.jsx)(o.AlertCircle,{size:20,className:"text-orange-500"})," Pacientes para Contato"]}),(0,s.jsxs)("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-100 divide-y divide-slate-50",children:[p.map(e=>(0,s.jsxs)("div",{className:`p-6 flex items-center justify-between hover:bg-slate-50 transition-all ${m?.clientId===e.id?"bg-teal-50":""}`,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-slate-900",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-slate-500",children:["Última sessão: ",e.lastSessionDate||"Sem registro"]})]}),(0,s.jsxs)("button",{onClick:()=>u(e),disabled:t===e.id,className:"bg-white border border-slate-200 px-4 py-2 rounded-xl text-sm font-bold text-slate-600 hover:border-teal-500 hover:text-teal-600 transition-all flex items-center gap-2 disabled:opacity-50",children:[t===e.id?(0,s.jsx)(l.RefreshCw,{size:16,className:"animate-spin"}):(0,s.jsx)(d,{size:16,className:"text-teal-500"}),"Gerar Mensagem IA"]})]},e.id)),0===p.length&&(0,s.jsx)("div",{className:"p-12 text-center text-slate-400 italic",children:"Todos os seus pacientes estão em dia! Parabéns pelo excelente trabalho de retenção."})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-slate-700 flex items-center gap-2 mb-4",children:[(0,s.jsx)(r,{size:20,className:"text-teal-500"})," Sugestão de Mensagem"]}),m?(0,s.jsxs)("div",{className:"bg-white rounded-3xl shadow-sm border border-teal-100 p-8 space-y-6 animate-fade-in",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-100",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-teal-100 rounded-full flex items-center justify-center text-teal-600",children:(0,s.jsx)(d,{size:20})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-slate-800",children:"IA Soraia Assistent"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Mensagem personalizada gerada agora"})]})]}),(0,s.jsx)("div",{className:"bg-slate-50 p-6 rounded-2xl border border-slate-200 relative",children:(0,s.jsxs)("p",{className:"text-slate-800 leading-relaxed italic",children:['"',m.message,'"']})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsxs)("button",{onClick:()=>{var s;let t,a=e.find(e=>e.id===m.clientId);a&&(s=a.phone,t=encodeURIComponent(m.message),window.open(`https://wa.me/${s.replace(/\D/g,"")}?text=${t}`,"_blank"))},className:"flex-1 bg-green-500 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-green-600 transition-all shadow-lg shadow-green-100",children:[(0,s.jsx)(r,{size:20})," Enviar WhatsApp"]}),(0,s.jsxs)("button",{className:"flex-1 bg-slate-900 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-slate-800 transition-all",children:[(0,s.jsx)(n.Mail,{size:20})," Enviar E-mail"]})]})]}):(0,s.jsxs)("div",{className:"bg-slate-100/50 rounded-3xl border-2 border-dashed border-slate-200 p-12 text-center text-slate-400",children:[(0,s.jsx)(d,{size:48,className:"mx-auto mb-4 opacity-20"}),(0,s.jsx)("p",{children:"Selecione um paciente ao lado para gerar uma mensagem personalizada de reativação usando Inteligência Artificial."})]})]})]})]})};var h=e.i(79207);function p(){let{clients:e,logout:a}=(0,h.useApp)();return(0,s.jsx)(t.default,{onLogout:a,children:(0,s.jsx)(m,{clients:e})})}e.s(["default",()=>p],50056)},107,(e,s,t)=>{let a="/admin/retention";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(50056)]),s.hot&&s.hot.dispose(function(){window.__NEXT_P.push([a])})},48761,e=>{e.v(s=>Promise.all(["static/chunks/fd7c0943d5cd5e09.js"].map(s=>e.l(s))).then(()=>s(93594)))},28805,e=>{e.v(s=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(s=>e.l(s))).then(()=>s(79466)))}]);